# День 07 - Агрегированные данные и OLAP конструкции

## _Извлечение "ценности" из данных через агрегацию_

**Описание:** Изучение OLAP конструкций и работы с агрегированными данными для аналитических целей.

## Изученные концепции

**OLTP vs OLAP:**
- OLTP - детализированные данные (сырой слой)
- OLAP - агрегированная информация (аналитический слой)

**Data Lifecycle Management:**
- TTL (Time-to-Live) политики
- Retention Data Policy
- LakeHouse = DataLake + DataWareHouse

## Выполненные задания

- **00**: Подсчет посещений по каждому человеку с сортировкой
- **01**: Топ-4 людей по посещениям с именами вместо ID
- **02**: Топ-3 ресторана по посещениям и заказам с action_type
- **03**: Объединение статистики посещений и заказов по ресторанам
- **04**: Люди с более чем 3 посещениями (HAVING без WHERE)
- **05**: Уникальные имена заказчиков без GROUP BY и операций множеств
- **06**: Статистика по пиццериям: количество, средняя/максимальная/минимальная цена
- **07**: Общий средний рейтинг всех ресторанов (global_rating)
- **08**: Количество заказов по адресам людей и пиццериям
- **09**: Сложная формула по возрастам: "MAX - (MIN/MAX)" vs среднее значение

**Пример сложной агрегации (задание 09):**
```sql
SELECT 
    address,
    ROUND(MAX(age) - (MIN(age)::numeric / MAX(age)), 2) as formula,
    ROUND(AVG(age), 2) as average,
    (MAX(age) - (MIN(age)::numeric / MAX(age))) > AVG(age) as comparison
FROM person
GROUP BY address;
```

## Технологии

- PostgreSQL  
- ANSI SQL
- Агрегатные функции: COUNT, AVG, MAX, MIN, SUM, ROUND
- GROUP BY, HAVING, UNION